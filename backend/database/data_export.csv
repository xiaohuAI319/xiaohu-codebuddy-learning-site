PRAGMA foreign_keys=OFF;
BEGIN TRANSACTION;
CREATE TABLE `Categories` (`id` VARCHAR(50) NOT NULL PRIMARY KEY, `name` VARCHAR(50) NOT NULL, `description` VARCHAR(200), `order` INTEGER NOT NULL DEFAULT 0, `isActive` TINYINT(1) NOT NULL DEFAULT 1, `createdAt` DATETIME NOT NULL, `updatedAt` DATETIME NOT NULL);
CREATE TABLE `membership_tiers_backup` (`id` INTEGER PRIMARY KEY, `name` VARCHAR(50) NOT NULL UNIQUE, `level` INTEGER NOT NULL, `priceRangeMin` DECIMAL(10,2) NOT NULL, `priceRangeMax` DECIMAL(10,2) NOT NULL, `color` VARCHAR(20) NOT NULL, `icon` VARCHAR(10) NOT NULL, `description` TEXT NOT NULL, `benefits` TEXT NOT NULL, `permissions` TEXT NOT NULL, `isActive` TINYINT(1) NOT NULL DEFAULT 1, `createdAt` DATETIME NOT NULL, `updatedAt` DATETIME NOT NULL);
INSERT INTO membership_tiers_backup VALUES(1,'学员',1,9.90000000000000035,99,'#10B981','🎓','入门级会员，享受基础学习权益','["查看基础内容","上传作品（每日3个）","参与投票","基础技术支持"]','{"canViewBasic":true,"canViewAdvanced":false,"canViewPremium":false,"canViewSource":false,"canUploadWorks":true,"canVote":true,"maxUploadsPerDay":3}',1,'2025-09-25 07:44:58.788 +00:00','2025-09-25 07:44:58.789 +00:00');
INSERT INTO membership_tiers_backup VALUES(2,'会员',2,100,999,'#3B82F6','⭐','标准会员，享受进阶学习权益','["学员所有权益","查看高级内容","上传作品（每日5个）","优先展示","专属会员标识"]','{"canViewBasic":true,"canViewAdvanced":true,"canViewPremium":false,"canViewSource":false,"canUploadWorks":true,"canVote":true,"maxUploadsPerDay":5}',1,'2025-09-25 07:44:58.801 +00:00','2025-09-25 07:44:58.801 +00:00');
INSERT INTO membership_tiers_backup VALUES(3,'高级会员',3,1000,4999,'#8B5CF6','💎','高级会员，享受专业学习权益','["会员所有权益","查看高端内容","上传作品（每日10个）","专属高级标识","优先技术支持"]','{"canViewBasic":true,"canViewAdvanced":true,"canViewPremium":true,"canViewSource":false,"canUploadWorks":true,"canVote":true,"maxUploadsPerDay":10}',1,'2025-09-25 07:44:58.809 +00:00','2025-09-25 07:44:58.809 +00:00');
INSERT INTO membership_tiers_backup VALUES(4,'共创',4,5000,14999,'#F59E0B','🚀','共创伙伴，参与内容创作和社区建设','["高级会员所有权益","查看源码","上传作品（每日20个）","参与内容创作","共创伙伴标识","专属交流群"]','{"canViewBasic":true,"canViewAdvanced":true,"canViewPremium":true,"canViewSource":true,"canUploadWorks":true,"canVote":true,"maxUploadsPerDay":20}',1,'2025-09-25 07:44:58.820 +00:00','2025-09-25 07:44:58.820 +00:00');
INSERT INTO membership_tiers_backup VALUES(5,'讲师',5,15000,99999,'#EF4444','👑','讲师级别，拥有最高权限和荣誉','["共创所有权益","无限制上传作品","发布课程","管理学员","讲师专属标识","收益分成"]','{"canViewBasic":true,"canViewAdvanced":true,"canViewPremium":true,"canViewSource":true,"canUploadWorks":true,"canVote":true,"maxUploadsPerDay":-1}',1,'2025-09-25 07:44:58.830 +00:00','2025-09-25 07:44:58.831 +00:00');
CREATE TABLE `membership_tiers` (`id` INTEGER PRIMARY KEY AUTOINCREMENT, `name` VARCHAR(50) NOT NULL UNIQUE, `level` INTEGER NOT NULL UNIQUE, `priceRangeMin` DECIMAL(10,2) NOT NULL, `priceRangeMax` DECIMAL(10,2) NOT NULL, `color` VARCHAR(20) NOT NULL, `icon` VARCHAR(10) NOT NULL, `description` TEXT NOT NULL, `benefits` TEXT NOT NULL, `permissions` TEXT NOT NULL, `isActive` TINYINT(1) NOT NULL DEFAULT 1, `createdAt` DATETIME NOT NULL, `updatedAt` DATETIME NOT NULL);
INSERT INTO membership_tiers VALUES(1,'学员',1,9.90000000000000035,99,'#10B981','🎓','入门级会员，享受基础学习权益','["查看基础内容","上传作品（每日3个）","参与投票","基础技术支持"]','{"canViewBasic":true,"canViewAdvanced":false,"canViewPremium":false,"canViewSource":false,"canUploadWorks":true,"canVote":true,"maxUploadsPerDay":3}',1,'2025-09-27 08:36:37.334 +00:00','2025-09-27 08:36:37.335 +00:00');
INSERT INTO membership_tiers VALUES(2,'会员',2,100,999,'#3B82F6','⭐','标准会员，享受进阶学习权益','["学员所有权益","查看高级内容","上传作品（每日5个）","优先展示","专属会员标识"]','{"canViewBasic":true,"canViewAdvanced":true,"canViewPremium":false,"canViewSource":false,"canUploadWorks":true,"canVote":true,"maxUploadsPerDay":5}',1,'2025-09-27 08:36:37.348 +00:00','2025-09-27 08:36:37.348 +00:00');
INSERT INTO membership_tiers VALUES(3,'高级会员',3,1000,4999,'#8B5CF6','💎','高级会员，享受专业学习权益','["会员所有权益","查看高端内容","上传作品（每日10个）","专属高级标识","优先技术支持"]','{"canViewBasic":true,"canViewAdvanced":true,"canViewPremium":true,"canViewSource":false,"canUploadWorks":true,"canVote":true,"maxUploadsPerDay":10}',1,'2025-09-27 08:36:37.357 +00:00','2025-09-27 08:36:37.357 +00:00');
INSERT INTO membership_tiers VALUES(4,'共创',4,5000,14999,'#F59E0B','🚀','共创伙伴，参与内容创作和社区建设','["高级会员所有权益","查看源码","上传作品（每日20个）","参与内容创作","共创伙伴标识","专属交流群"]','{"canViewBasic":true,"canViewAdvanced":true,"canViewPremium":true,"canViewSource":true,"canUploadWorks":true,"canVote":true,"maxUploadsPerDay":20}',1,'2025-09-27 08:36:37.366 +00:00','2025-09-27 08:36:37.366 +00:00');
INSERT INTO membership_tiers VALUES(5,'讲师',5,15000,99999,'#EF4444','👑','讲师级别，拥有最高权限和荣誉','["共创所有权益","无限制上传作品","发布课程","管理学员","讲师专属标识","收益分成"]','{"canViewBasic":true,"canViewAdvanced":true,"canViewPremium":true,"canViewSource":true,"canUploadWorks":true,"canVote":true,"maxUploadsPerDay":-1}',1,'2025-09-27 08:36:37.374 +00:00','2025-09-27 08:36:37.374 +00:00');
CREATE TABLE `users` (`id` INTEGER PRIMARY KEY AUTOINCREMENT, `username` VARCHAR(50) NOT NULL UNIQUE, `email` VARCHAR(100) NOT NULL UNIQUE, `password` VARCHAR(255) NOT NULL, `nickname` VARCHAR(50) NOT NULL, `role` TEXT NOT NULL DEFAULT 'student', `avatar` VARCHAR(255), `bio` TEXT, `joinDate` DATETIME NOT NULL, `isActive` TINYINT(1) NOT NULL DEFAULT 1, `membershipTierId` INTEGER REFERENCES `membership_tiers` (`id`) ON DELETE SET NULL ON UPDATE CASCADE, `currentLevel` VARCHAR(50) NOT NULL DEFAULT '学员', `totalSpent` DECIMAL(10,2) NOT NULL DEFAULT 0, `totalPaid` DECIMAL(10,2) NOT NULL DEFAULT 0, `membershipExpiry` DATETIME, `availableCoupons` TEXT NOT NULL DEFAULT '[]', `usedCoupons` TEXT NOT NULL DEFAULT '[]', `paymentHistory` TEXT NOT NULL DEFAULT '[]', `createdAt` DATETIME NOT NULL, `updatedAt` DATETIME NOT NULL);
INSERT INTO users VALUES(1,'小虎admin','admin@xiaohu.com','$2a$12$3x74P/8xgQlQV69SOJkO1uZuLfLsUre/dmBwv/65o5fHckDAYMvTK','小虎','admin',NULL,'小虎CodeBuddy学习站创始人，致力于AI编程教育','2025-09-27 08:36:37.385 +00:00',1,5,'讲师',0,0,'2026-09-27 08:36:37.385 +00:00','[]','[]','[]','2025-09-27 08:36:37.385 +00:00','2025-09-27 08:36:37.386 +00:00');
INSERT INTO users VALUES(2,'982620','982620@qq.com','$2a$12$5/5i2ghjj2nbdPLZOPH71evJPeD8tXX9x6Njl/WC9z8.Z.tozekn.','小虎AI','student',NULL,NULL,'2025-09-27 08:53:16.635 +00:00',1,NULL,'用户',0,0,NULL,'[]','[]','[]','2025-09-27 08:53:16.635 +00:00','2025-09-27 08:53:16.637 +00:00');
INSERT INTO users VALUES(3,'testuser','test@example.com','$2a$12$5ypjzTB35.E.qBJ2dwViXeYD30g2lZ7bjahfoy602AqQ5/favI5Xq','�����û�','student',NULL,NULL,'2025-09-27 08:59:47.849 +00:00',1,NULL,'用户',0,0,NULL,'[]','[]','[]','2025-09-27 08:59:47.849 +00:00','2025-09-27 08:59:47.849 +00:00');
CREATE TABLE `Works` (`id` INTEGER PRIMARY KEY AUTOINCREMENT, `title` VARCHAR(100) NOT NULL, `description` TEXT NOT NULL, `coverImage` VARCHAR(500) NOT NULL, `slug` VARCHAR(100) UNIQUE, `htmlFile` VARCHAR(500), `link` VARCHAR(500), `category` TEXT NOT NULL DEFAULT 'other', `tags` VARCHAR(500), `repositoryUrl` VARCHAR(500), `prompt` TEXT NOT NULL, `bootcamp` VARCHAR(100), `author` INTEGER NOT NULL REFERENCES `Users` (`id`) ON DELETE NO ACTION ON UPDATE CASCADE, `votes` INTEGER NOT NULL DEFAULT 0, `isPinned` TINYINT(1) NOT NULL DEFAULT 0, `visibility` TEXT NOT NULL DEFAULT 'public', `createdAt` DATETIME NOT NULL, `updatedAt` DATETIME NOT NULL);
INSERT INTO Works VALUES(1,'AI聊天机器人','基于GPT的智能聊天机器人，支持多轮对话和上下文理解。使用React + Node.js构建，具有流畅的用户界面和强大的后端支持。','/uploads/default-cover-4.jpg','4613d5055d6f',NULL,'https://example.com/ai-chatbot-demo','web','AI,React,Node.js,聊天机器人','https://github.com/example/ai-chatbot','请设计一个现代化的AI聊天机器人界面，需要支持：1) 多轮对话显示 2) 输入框带有发送按钮 3) 侧边栏显示对话历史 4) 响应式设计 5) 深色/浅色主题切换',NULL,1,40,0,'public','2025-09-27 08:44:50.478 +00:00','2025-09-27 08:59:56.425 +00:00');
INSERT INTO Works VALUES(2,'图片识别应用','使用TensorFlow.js构建的图像识别Web应用，可以实时识别物体、人脸和场景。支持图片上传和摄像头拍照功能。','/uploads/default-cover-5.jpg','f4f36ca0e27e',NULL,'https://example.com/image-recognition-demo','web','AI,TensorFlow.js,图像识别,JavaScript','https://github.com/example/image-recognition','创建一个图像识别Web应用，包含以下功能：1) 图片上传区域 2) 拖拽上传支持 3) 摄像头拍照功能 4) 识别结果显示 5) 置信度评分显示',NULL,1,47,0,'public','2025-09-27 08:44:50.496 +00:00','2025-09-27 08:44:50.496 +00:00');
INSERT INTO Works VALUES(3,'任务管理系统','功能完整的任务管理系统，支持团队协作、任务分配、进度跟踪和文件共享。使用Vue.js和Express.js开发。','/uploads/default-cover-1.jpg','468290fe7832',NULL,'https://example.com/task-manager-demo','web','Vue.js,任务管理,团队协作,Express.js','https://github.com/example/task-manager','设计一个任务管理系统界面，包含：1) 看板视图 2) 列表视图 3) 任务详情弹窗 4) 成员分配功能 5) 进度条显示 6) 截止日期管理',NULL,1,21,0,'public','2025-09-27 08:44:50.506 +00:00','2025-09-27 08:44:50.506 +00:00');
INSERT INTO Works VALUES(4,'天气应用','美观的天气查询应用，支持多城市管理、天气预报和天气图表展示。使用React Native开发，支持iOS和Android。','/uploads/default-cover-4.jpg','7b45e46fc696',NULL,'https://example.com/weather-app-demo','mobile','React Native,天气,移动应用,API集成','https://github.com/example/weather-app','开发一个天气应用界面，要求：1) 当前天气显示 2) 7天预报 3) 小时级预报 4) 多城市管理 5) 天气图表 6) 背景根据天气变化',NULL,1,2,0,'public','2025-09-27 08:44:50.522 +00:00','2025-09-27 08:53:28.945 +00:00');
INSERT INTO Works VALUES(5,'代码编辑器','基于Monaco Editor的在线代码编辑器，支持语法高亮、代码补全和实时预览功能。','/uploads/default-cover-2.jpg','f886b8ce2768',NULL,'https://example.com/code-editor-demo','web','Monaco Editor,代码编辑,语法高亮,实时预览','https://github.com/example/code-editor','创建一个在线代码编辑器，需要：1) 代码编辑区域 2) 实时预览区域 3) 文件树结构 4) 语法高亮 5) 代码补全 6) 主题切换',NULL,1,5,0,'public','2025-09-27 08:44:50.533 +00:00','2025-09-27 08:44:50.533 +00:00');
CREATE TABLE `bootcamps` (`id` INTEGER PRIMARY KEY AUTOINCREMENT, `name` VARCHAR(100) NOT NULL UNIQUE, `description` TEXT NOT NULL, `startDate` DATETIME NOT NULL, `endDate` DATETIME NOT NULL, `isActive` TINYINT(1) NOT NULL DEFAULT 1, `instructorIds` TEXT NOT NULL DEFAULT '[]', `studentIds` TEXT NOT NULL DEFAULT '[]', `maxStudents` INTEGER NOT NULL DEFAULT 50, `tags` TEXT NOT NULL DEFAULT '[]', `createdAt` DATETIME NOT NULL, `updatedAt` DATETIME NOT NULL);
INSERT INTO bootcamps VALUES(1,'AI编程训练营第一期','首期AI编程训练营，学习使用AI工具进行高效编程','2024-01-01 00:00:00.000 +00:00','2024-03-31 00:00:00.000 +00:00',1,'[]','[]',50,'["AI编程","基础入门","实战项目"]','2025-09-27 08:36:37.664 +00:00','2025-09-27 08:36:37.665 +00:00');
INSERT INTO bootcamps VALUES(2,'AI编程训练营第二期','第二期AI编程训练营，进阶AI编程技巧和项目实战','2024-04-01 00:00:00.000 +00:00','2024-06-30 00:00:00.000 +00:00',1,'[]','[]',100,'["AI编程","进阶提升","团队协作"]','2025-09-27 08:36:37.673 +00:00','2025-09-27 08:36:37.673 +00:00');
INSERT INTO bootcamps VALUES(3,'AI编程出海训练营第一期','专注于AI编程出海项目，学习国际化开发和部署','2024-07-01 00:00:00.000 +00:00','2024-09-30 00:00:00.000 +00:00',1,'[]','[]',30,'["AI编程","出海项目","国际化"]','2025-09-27 08:36:37.681 +00:00','2025-09-27 08:36:37.681 +00:00');
CREATE TABLE `coupons` (`id` INTEGER PRIMARY KEY AUTOINCREMENT, `code` VARCHAR(50) NOT NULL UNIQUE, `name` VARCHAR(100) NOT NULL, `description` TEXT NOT NULL, `discountType` TEXT NOT NULL, `discountValue` DECIMAL(10,2) NOT NULL, `minPurchaseAmount` DECIMAL(10,2) NOT NULL DEFAULT 0, `maxDiscountAmount` DECIMAL(10,2), `usageLimit` INTEGER NOT NULL, `usedCount` INTEGER NOT NULL DEFAULT 0, `validFrom` DATETIME NOT NULL, `validTo` DATETIME NOT NULL, `isActive` TINYINT(1) NOT NULL DEFAULT 1, `applicableTierIds` TEXT NOT NULL DEFAULT '[]', `createdById` INTEGER NOT NULL REFERENCES `users` (`id`) ON DELETE NO ACTION ON UPDATE CASCADE, `createdAt` DATETIME NOT NULL, `updatedAt` DATETIME NOT NULL);
INSERT INTO coupons VALUES(1,'WELCOME10','新用户欢迎券','新用户专享10%折扣','percentage',10,50,100,100,0,'2025-09-27 08:36:37.690 +00:00','2025-10-27 08:36:37.690 +00:00',1,'[1,2,3,4,5]',1,'2025-09-27 08:36:37.692 +00:00','2025-09-27 08:36:37.692 +00:00');
INSERT INTO coupons VALUES(2,'STUDENT50','学生专享券','学生用户专享50元减免','fixed',50,200,NULL,50,0,'2025-09-27 08:36:37.691 +00:00','2025-11-26 08:36:37.691 +00:00',1,'[1,2]',1,'2025-09-27 08:36:37.701 +00:00','2025-09-27 08:36:37.701 +00:00');
INSERT INTO coupons VALUES(3,'VIP20','VIP专享券','VIP用户专享20%折扣','percentage',20,1000,500,20,0,'2025-09-27 08:36:37.691 +00:00','2025-12-26 08:36:37.691 +00:00',1,'[3,4,5]',1,'2025-09-27 08:36:37.713 +00:00','2025-09-27 08:36:37.713 +00:00');
CREATE TABLE `serial_codes` (`id` INTEGER PRIMARY KEY AUTOINCREMENT, `code` VARCHAR(100) NOT NULL UNIQUE, `membershipTierId` INTEGER NOT NULL REFERENCES `membership_tiers` (`id`) ON DELETE NO ACTION ON UPDATE CASCADE, `isUsed` TINYINT(1) NOT NULL DEFAULT 0, `usedById` INTEGER REFERENCES `users` (`id`) ON DELETE SET NULL ON UPDATE CASCADE, `usedAt` DATETIME, `validFrom` DATETIME NOT NULL, `validTo` DATETIME NOT NULL, `batchId` VARCHAR(100) NOT NULL, `createdById` INTEGER NOT NULL REFERENCES `users` (`id`) ON DELETE NO ACTION ON UPDATE CASCADE, `createdAt` DATETIME NOT NULL, `updatedAt` DATETIME NOT NULL);
INSERT INTO serial_codes VALUES(1,'学员-1758962197731-001',1,0,NULL,NULL,'2025-09-27 08:36:37.733 +00:00','2026-09-27 08:36:37.733 +00:00','INIT-学员-2025-09-27',1,'2025-09-27 08:36:37.735 +00:00','2025-09-27 08:36:37.735 +00:00');
INSERT INTO serial_codes VALUES(2,'学员-1758962197744-002',1,0,NULL,NULL,'2025-09-27 08:36:37.746 +00:00','2026-09-27 08:36:37.746 +00:00','INIT-学员-2025-09-27',1,'2025-09-27 08:36:37.746 +00:00','2025-09-27 08:36:37.746 +00:00');
INSERT INTO serial_codes VALUES(3,'学员-1758962197752-003',1,0,NULL,NULL,'2025-09-27 08:36:37.754 +00:00','2026-09-27 08:36:37.754 +00:00','INIT-学员-2025-09-27',1,'2025-09-27 08:36:37.754 +00:00','2025-09-27 08:36:37.754 +00:00');
INSERT INTO serial_codes VALUES(4,'学员-1758962197761-004',1,0,NULL,NULL,'2025-09-27 08:36:37.762 +00:00','2026-09-27 08:36:37.762 +00:00','INIT-学员-2025-09-27',1,'2025-09-27 08:36:37.762 +00:00','2025-09-27 08:36:37.762 +00:00');
INSERT INTO serial_codes VALUES(5,'学员-1758962197769-005',1,0,NULL,NULL,'2025-09-27 08:36:37.770 +00:00','2026-09-27 08:36:37.770 +00:00','INIT-学员-2025-09-27',1,'2025-09-27 08:36:37.770 +00:00','2025-09-27 08:36:37.770 +00:00');
INSERT INTO serial_codes VALUES(6,'会员-1758962197780-001',2,0,NULL,NULL,'2025-09-27 08:36:37.781 +00:00','2026-09-27 08:36:37.781 +00:00','INIT-会员-2025-09-27',1,'2025-09-27 08:36:37.781 +00:00','2025-09-27 08:36:37.781 +00:00');
INSERT INTO serial_codes VALUES(7,'会员-1758962197787-002',2,0,NULL,NULL,'2025-09-27 08:36:37.789 +00:00','2026-09-27 08:36:37.789 +00:00','INIT-会员-2025-09-27',1,'2025-09-27 08:36:37.789 +00:00','2025-09-27 08:36:37.789 +00:00');
INSERT INTO serial_codes VALUES(8,'会员-1758962197795-003',2,0,NULL,NULL,'2025-09-27 08:36:37.797 +00:00','2026-09-27 08:36:37.797 +00:00','INIT-会员-2025-09-27',1,'2025-09-27 08:36:37.797 +00:00','2025-09-27 08:36:37.797 +00:00');
INSERT INTO serial_codes VALUES(9,'会员-1758962197804-004',2,0,NULL,NULL,'2025-09-27 08:36:37.805 +00:00','2026-09-27 08:36:37.805 +00:00','INIT-会员-2025-09-27',1,'2025-09-27 08:36:37.805 +00:00','2025-09-27 08:36:37.805 +00:00');
INSERT INTO serial_codes VALUES(10,'会员-1758962197812-005',2,0,NULL,NULL,'2025-09-27 08:36:37.814 +00:00','2026-09-27 08:36:37.814 +00:00','INIT-会员-2025-09-27',1,'2025-09-27 08:36:37.814 +00:00','2025-09-27 08:36:37.814 +00:00');
INSERT INTO serial_codes VALUES(11,'高级会员-1758962197820-001',3,0,NULL,NULL,'2025-09-27 08:36:37.822 +00:00','2026-09-27 08:36:37.822 +00:00','INIT-高级会员-2025-09-27',1,'2025-09-27 08:36:37.822 +00:00','2025-09-27 08:36:37.822 +00:00');
INSERT INTO serial_codes VALUES(12,'高级会员-1758962197829-002',3,0,NULL,NULL,'2025-09-27 08:36:37.830 +00:00','2026-09-27 08:36:37.830 +00:00','INIT-高级会员-2025-09-27',1,'2025-09-27 08:36:37.830 +00:00','2025-09-27 08:36:37.830 +00:00');
INSERT INTO serial_codes VALUES(13,'高级会员-1758962197836-003',3,0,NULL,NULL,'2025-09-27 08:36:37.838 +00:00','2026-09-27 08:36:37.838 +00:00','INIT-高级会员-2025-09-27',1,'2025-09-27 08:36:37.838 +00:00','2025-09-27 08:36:37.838 +00:00');
INSERT INTO serial_codes VALUES(14,'高级会员-1758962197845-004',3,0,NULL,NULL,'2025-09-27 08:36:37.846 +00:00','2026-09-27 08:36:37.846 +00:00','INIT-高级会员-2025-09-27',1,'2025-09-27 08:36:37.847 +00:00','2025-09-27 08:36:37.847 +00:00');
INSERT INTO serial_codes VALUES(15,'高级会员-1758962197853-005',3,0,NULL,NULL,'2025-09-27 08:36:37.854 +00:00','2026-09-27 08:36:37.854 +00:00','INIT-高级会员-2025-09-27',1,'2025-09-27 08:36:37.854 +00:00','2025-09-27 08:36:37.854 +00:00');
INSERT INTO serial_codes VALUES(16,'共创-1758962197862-001',4,0,NULL,NULL,'2025-09-27 08:36:37.863 +00:00','2026-09-27 08:36:37.863 +00:00','INIT-共创-2025-09-27',1,'2025-09-27 08:36:37.863 +00:00','2025-09-27 08:36:37.863 +00:00');
INSERT INTO serial_codes VALUES(17,'共创-1758962197870-002',4,0,NULL,NULL,'2025-09-27 08:36:37.872 +00:00','2026-09-27 08:36:37.872 +00:00','INIT-共创-2025-09-27',1,'2025-09-27 08:36:37.872 +00:00','2025-09-27 08:36:37.872 +00:00');
INSERT INTO serial_codes VALUES(18,'共创-1758962197879-003',4,0,NULL,NULL,'2025-09-27 08:36:37.880 +00:00','2026-09-27 08:36:37.880 +00:00','INIT-共创-2025-09-27',1,'2025-09-27 08:36:37.880 +00:00','2025-09-27 08:36:37.880 +00:00');
INSERT INTO serial_codes VALUES(19,'共创-1758962197887-004',4,0,NULL,NULL,'2025-09-27 08:36:37.889 +00:00','2026-09-27 08:36:37.889 +00:00','INIT-共创-2025-09-27',1,'2025-09-27 08:36:37.889 +00:00','2025-09-27 08:36:37.889 +00:00');
INSERT INTO serial_codes VALUES(20,'共创-1758962197896-005',4,0,NULL,NULL,'2025-09-27 08:36:37.897 +00:00','2026-09-27 08:36:37.897 +00:00','INIT-共创-2025-09-27',1,'2025-09-27 08:36:37.897 +00:00','2025-09-27 08:36:37.897 +00:00');
INSERT INTO serial_codes VALUES(21,'讲师-1758962197903-001',5,0,NULL,NULL,'2025-09-27 08:36:37.905 +00:00','2026-09-27 08:36:37.905 +00:00','INIT-讲师-2025-09-27',1,'2025-09-27 08:36:37.905 +00:00','2025-09-27 08:36:37.905 +00:00');
INSERT INTO serial_codes VALUES(22,'讲师-1758962197911-002',5,0,NULL,NULL,'2025-09-27 08:36:37.912 +00:00','2026-09-27 08:36:37.912 +00:00','INIT-讲师-2025-09-27',1,'2025-09-27 08:36:37.913 +00:00','2025-09-27 08:36:37.913 +00:00');
INSERT INTO serial_codes VALUES(23,'讲师-1758962197920-003',5,0,NULL,NULL,'2025-09-27 08:36:37.921 +00:00','2026-09-27 08:36:37.921 +00:00','INIT-讲师-2025-09-27',1,'2025-09-27 08:36:37.921 +00:00','2025-09-27 08:36:37.921 +00:00');
INSERT INTO serial_codes VALUES(24,'讲师-1758962197928-004',5,0,NULL,NULL,'2025-09-27 08:36:37.930 +00:00','2026-09-27 08:36:37.930 +00:00','INIT-讲师-2025-09-27',1,'2025-09-27 08:36:37.930 +00:00','2025-09-27 08:36:37.930 +00:00');
INSERT INTO serial_codes VALUES(25,'讲师-1758962197937-005',5,0,NULL,NULL,'2025-09-27 08:36:37.939 +00:00','2026-09-27 08:36:37.939 +00:00','INIT-讲师-2025-09-27',1,'2025-09-27 08:36:37.939 +00:00','2025-09-27 08:36:37.939 +00:00');
CREATE TABLE `operation_logs` (`id` INTEGER PRIMARY KEY AUTOINCREMENT, `userId` INTEGER REFERENCES `users` (`id`) ON DELETE SET NULL ON UPDATE CASCADE, `operatorId` INTEGER REFERENCES `users` (`id`) ON DELETE SET NULL ON UPDATE CASCADE, `operationType` VARCHAR(50) NOT NULL, `operationDetail` TEXT NOT NULL, `targetUserId` INTEGER REFERENCES `users` (`id`) ON DELETE SET NULL ON UPDATE CASCADE, `oldValue` TEXT, `newValue` TEXT, `ipAddress` VARCHAR(45), `userAgent` TEXT, `createdAt` DATETIME NOT NULL, `updatedAt` DATETIME NOT NULL);
CREATE TABLE `membership_upgrades` (`id` INTEGER PRIMARY KEY AUTOINCREMENT, `userId` INTEGER NOT NULL REFERENCES `users` (`id`) ON DELETE NO ACTION ON UPDATE CASCADE, `fromLevel` VARCHAR(50) NOT NULL, `toLevel` VARCHAR(50) NOT NULL, `upgradeType` TEXT NOT NULL, `operatorId` INTEGER REFERENCES `users` (`id`) ON DELETE SET NULL ON UPDATE CASCADE, `serialCodeId` INTEGER REFERENCES `serial_codes` (`id`) ON DELETE SET NULL ON UPDATE CASCADE, `reason` TEXT, `createdAt` DATETIME NOT NULL, `updatedAt` DATETIME NOT NULL);
CREATE TABLE `votes` (`id` INTEGER PRIMARY KEY AUTOINCREMENT, `userId` INTEGER NOT NULL REFERENCES `users` (`id`) ON DELETE NO ACTION ON UPDATE CASCADE, `workId` INTEGER NOT NULL REFERENCES `works` (`id`) ON DELETE NO ACTION ON UPDATE CASCADE, `createdAt` DATETIME NOT NULL, `updatedAt` DATETIME NOT NULL);
INSERT INTO votes VALUES(1,2,4,'2025-09-27 08:53:28.935 +00:00','2025-09-27 08:53:28.936 +00:00');
INSERT INTO votes VALUES(2,3,1,'2025-09-27 08:59:56.415 +00:00','2025-09-27 08:59:56.415 +00:00');
INSERT INTO sqlite_sequence VALUES('membership_tiers',5);
INSERT INTO sqlite_sequence VALUES('users',3);
INSERT INTO sqlite_sequence VALUES('bootcamps',3);
INSERT INTO sqlite_sequence VALUES('coupons',3);
INSERT INTO sqlite_sequence VALUES('serial_codes',25);
INSERT INTO sqlite_sequence VALUES('Works',5);
INSERT INTO sqlite_sequence VALUES('votes',2);
CREATE INDEX `categories_order` ON `Categories` (`order`);
CREATE INDEX `categories_is_active` ON `Categories` (`isActive`);
CREATE INDEX `categories_created_at` ON `Categories` (`createdAt`);
CREATE INDEX `membership_tiers_level` ON `membership_tiers` (`level`);
CREATE INDEX `membership_tiers_is_active` ON `membership_tiers` (`isActive`);
CREATE INDEX `membership_tiers_price_range_min_price_range_max` ON `membership_tiers` (`priceRangeMin`, `priceRangeMax`);
CREATE INDEX `users_email` ON `users` (`email`);
CREATE INDEX `users_username` ON `users` (`username`);
CREATE INDEX `users_membership_tier_id` ON `users` (`membershipTierId`);
CREATE INDEX `users_role` ON `users` (`role`);
CREATE INDEX `works_author` ON `Works` (`author`);
CREATE INDEX `works_category` ON `Works` (`category`);
CREATE INDEX `works_bootcamp` ON `Works` (`bootcamp`);
CREATE INDEX `works_is_pinned_votes` ON `Works` (`isPinned`, `votes`);
CREATE INDEX `works_visibility` ON `Works` (`visibility`);
CREATE INDEX `works_created_at` ON `Works` (`createdAt`);
CREATE INDEX `bootcamps_name` ON `bootcamps` (`name`);
CREATE INDEX `bootcamps_is_active` ON `bootcamps` (`isActive`);
CREATE INDEX `bootcamps_start_date_end_date` ON `bootcamps` (`startDate`, `endDate`);
CREATE INDEX `coupons_code` ON `coupons` (`code`);
CREATE INDEX `coupons_is_active` ON `coupons` (`isActive`);
CREATE INDEX `coupons_valid_from_valid_to` ON `coupons` (`validFrom`, `validTo`);
CREATE INDEX `coupons_created_by_id` ON `coupons` (`createdById`);
CREATE INDEX `serial_codes_code` ON `serial_codes` (`code`);
CREATE INDEX `serial_codes_is_used` ON `serial_codes` (`isUsed`);
CREATE INDEX `serial_codes_membership_tier_id` ON `serial_codes` (`membershipTierId`);
CREATE INDEX `serial_codes_batch_id` ON `serial_codes` (`batchId`);
CREATE INDEX `serial_codes_created_by_id` ON `serial_codes` (`createdById`);
CREATE INDEX `operation_logs_user_id` ON `operation_logs` (`userId`);
CREATE INDEX `operation_logs_operator_id` ON `operation_logs` (`operatorId`);
CREATE INDEX `operation_logs_operation_type` ON `operation_logs` (`operationType`);
CREATE INDEX `operation_logs_target_user_id` ON `operation_logs` (`targetUserId`);
CREATE INDEX `operation_logs_created_at` ON `operation_logs` (`createdAt`);
CREATE INDEX `membership_upgrades_user_id` ON `membership_upgrades` (`userId`);
CREATE INDEX `membership_upgrades_upgrade_type` ON `membership_upgrades` (`upgradeType`);
CREATE INDEX `membership_upgrades_operator_id` ON `membership_upgrades` (`operatorId`);
CREATE INDEX `membership_upgrades_serial_code_id` ON `membership_upgrades` (`serialCodeId`);
CREATE INDEX `membership_upgrades_created_at` ON `membership_upgrades` (`createdAt`);
CREATE UNIQUE INDEX `votes_user_id_work_id` ON `votes` (`userId`, `workId`);
CREATE UNIQUE INDEX `works_slug` ON `Works` (`slug`);
COMMIT;
